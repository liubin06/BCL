import matplotlib.pyplot as plt
import numpy as np
font_dict=dict(fontsize=20,
              color='black',
              family='Times New Roman',
              weight='light',
              style='italic',
              )
plt.rc('font', family='Times New Roman', size=12)
x = np.linspace(0,1,100)
tau_plus = 0.1
tau_minus = 0.9


def cdf_trans(tau_plus,alpha,p):
    a = (1-2*tau_plus)*(1-2*alpha-1e-8)
    b = 2*alpha*(1-tau_plus)+ tau_plus*(2-2*alpha+1e-8)
    c = -p
    cdf = (-b + np.sqrt(b**2-4*a*c))/(2*a)
    return cdf

def w(alpha,beta,cdf_u):
    cdf = cdf_trans(tau_plus, alpha, cdf_u)
    ccdf = 1 - cdf
    phi1 = 2 * ccdf
    phi2 = 2 * cdf

    x_tn = alpha * phi1 + (1 - alpha) * phi2
    x_fn = (1 - alpha) * phi1 + alpha * phi2

    x_htn = (alpha * (1 - beta) * phi1 + (1 - alpha) * beta * phi2) / (alpha * (1 - beta) + (1 - alpha) * beta +1e-8)
    omega = x_htn / (x_tn * (1 - tau_plus) + x_fn * tau_plus)
    return omega

beta=1
plt.subplot(231)
y1 = w(0.9999,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 1.00')
y1 = w(0.98,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.98')
y1 = w(0.96,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.96')
y1 = w(0.94,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.94')
y1 = w(0.92,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.92')
y1 = w(0.90,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.90')
y1 = w(0.80,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.80')
y1 = w(0.70,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.70')
y1 = w(0.60,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.60')
y1 = w(0.50,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.50')
plt.legend()
plt.grid()
plt.xlabel(r'$\hat\Phi(x)$')
plt.ylabel(r'$\omega$')
plt.title(r'$\beta={}$'.format(beta))

beta=0.90
plt.subplot(232)
y1 = w(0.9999,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 1.00')
y1 = w(0.98,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.98')
y1 = w(0.96,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.96')
y1 = w(0.94,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.94')
y1 = w(0.92,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.92')
y1 = w(0.90,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.90')
y1 = w(0.80,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.80')
y1 = w(0.70,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.70')
y1 = w(0.60,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.60')
y1 = w(0.50,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.50')
plt.legend()
plt.grid()
plt.xlabel(r'$\hat\Phi(x)$')
plt.ylabel(r'$\omega$')
plt.title(r'$\beta={}$'.format(beta))

beta=0.80
plt.subplot(233)
y1 = w(0.9999,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 1.00')
y1 = w(0.98,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.98')
y1 = w(0.96,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.96')
y1 = w(0.94,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.94')
y1 = w(0.92,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.92')
y1 = w(0.90,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.90')
y1 = w(0.80,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.80')
y1 = w(0.70,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.70')
y1 = w(0.60,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.60')
y1 = w(0.50,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.50')
plt.legend()
plt.grid()
plt.xlabel(r'$\hat\Phi(x)$')
plt.ylabel(r'$\omega$')
plt.title(r'$\beta={}$'.format(beta))

beta=0.70
plt.subplot(234)
y1 = w(0.9999,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 1.00')
y1 = w(0.98,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.98')
y1 = w(0.96,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.96')
y1 = w(0.94,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.94')
y1 = w(0.92,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.92')
y1 = w(0.90,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.90')
y1 = w(0.80,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.80')
y1 = w(0.70,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.70')
y1 = w(0.60,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.60')
y1 = w(0.50,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.50')
plt.legend()
plt.grid()
plt.xlabel(r'$\hat\Phi(x)$')
plt.ylabel(r'$\omega$')
plt.title(r'$\beta={}$'.format(beta))

beta=0.60
plt.subplot(235)
y1 = w(0.9999,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 1.00')
y1 = w(0.98,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.98')
y1 = w(0.96,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.96')
y1 = w(0.94,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.94')
y1 = w(0.92,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.92')
y1 = w(0.90,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.90')
y1 = w(0.80,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.80')
y1 = w(0.70,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.70')
y1 = w(0.60,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.60')
y1 = w(0.50,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.50')
plt.legend()
plt.grid()
plt.xlabel(r'$\hat\Phi(x)$')
plt.ylabel(r'$\omega$')
plt.title(r'$\beta={}$'.format(beta))


beta=0.50
plt.subplot(236)
y1 = w(0.9999,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 1.00')
y1 = w(0.98,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.98')
y1 = w(0.96,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.96')
y1 = w(0.94,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.94')
y1 = w(0.92,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.92')
y1 = w(0.90,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.90')
y1 = w(0.80,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.80')
y1 = w(0.70,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.70')
y1 = w(0.60,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.60')
y1 = w(0.50,beta,x)
plt.plot(x,y1,label=r'$\alpha$ = 0.50')
plt.legend()
plt.grid()
plt.xlabel(r'$\hat\Phi(x)$')
plt.ylabel(r'$\omega$')
plt.title(r'$\beta={}$'.format(beta))
plt.show()